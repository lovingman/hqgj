{"version":3,"sources":["webpack:///./src/api/sys.js","webpack:///./src/views/zcpa/publics/photo.vue?4f0a","webpack:///./src/views/zcpa/publics/photo.vue?6826","webpack:///src/views/zcpa/publics/photo.vue","webpack:///./src/views/zcpa/publics/photo.vue?1acc","webpack:///./src/views/zcpa/publics/photo.vue"],"names":["__webpack_require__","d","__webpack_exports__","getAreaTree","getDict","fileUpload","filedown","fileUpImg","_utils_request__WEBPACK_IMPORTED_MODULE_0__","query","request","url","method","params","ids","categoryIds","fileobj","param","FormData","append","file","headers","Content-Type","data","responseType","transformRequest","ret","it","encodeURIComponent","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_10_oneOf_1_0_node_modules_css_loader_index_js_ref_10_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_10_oneOf_1_2_node_modules_less_loader_dist_cjs_js_ref_10_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_photo_vue_vue_type_style_index_0_id_223a6de2_lang_less_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_10_oneOf_1_0_node_modules_css_loader_index_js_ref_10_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_10_oneOf_1_2_node_modules_less_loader_dist_cjs_js_ref_10_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_photo_vue_vue_type_style_index_0_id_223a6de2_lang_less_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","n","render","_vm","this","_h","$createElement","_c","_self","staticClass","class","picture","hides","attrs","label","prop","hide","hideUpload","action","list-type","limit","limitImgCount","file-list","imgObj","imgArr","http-request","uploadServerEdit","on-success","unitPictrueUploadSuccess","on-preview","unitPictureCardPreview","before-upload","beforeAvatarUpload","on-remove","unitPictrueRemove","staticStyle","font-size","_v","visible","dialogUnitVisible","append-to-body","on","update:visible","$event","width","src","unitImageUrl","staticRenderFns","photovue_type_script_lang_js_","name","props","submitType","type","String","form","Object","watch","handler","newName","oldName","immediate","deep","form.fmUrl","console","log","initEditForm","fmUrl","imgObj.imgArr","img","created","methods","tempImgArr","split","length","forEach","item","i","push","response","fileList","status","tempArr","pictureStr","join","that","reader","FileReader","Image","filename","readAsDataURL","newUrl","onload","e","result","target","canvas","document","createElement","context","getContext","originWidth","originHeight","height","maxWidth","globalData","albumWidth","maxHeight","albumHeight","targetWidth","targetHeight","Math","round","clearRect","drawImage","toDataURL","obj","actionUrls","projectId","id","coverUrl","imageUpload","_this","sys","then","$message","message","isRightType","test","imgSize","size","warning","unitPictrueBeforeRemove","imgArrTemp","splice","publics_photovue_type_script_lang_js_","component","componentNormalizer"],"mappings":"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","file":"assets/js/chunk-c6ac41ee.a390b1af.js","sourcesContent":["import request from '@/utils/request'\r\n// export function getAreaTree(query) {\r\n//   return request({\r\n//     url: '/portal/system/getAreaTree',\r\n//     method: 'get',\r\n//     params: query\r\n//   })\r\n// }\r\n// export function initProvinceCity(query) {\r\n//   return request({\r\n//     url: '/portal/system/getAreaTree?pid=00&type=4',\r\n//     method: 'get',\r\n//     params: query\r\n//   })\r\n// }\r\n// export function getDict(ids) {\r\n//   return request({\r\n//     url: '/portal/dict/getByCategoryIds',\r\n//     method: 'get',\r\n//     params: {categoryIds:ids}\r\n//   })\r\n// }\r\n// export function fileUpload(fileobj,url) {\r\n//   let param = new FormData()\r\n//   param.append('file',fileobj.file)\r\n//   return request({\r\n//     method: 'post',\r\n//     url: url,\r\n//     headers: {'Content-Type':'multipart/form-data'},\r\n//     data: param\r\n//   })\r\n// }\r\n//\r\n// export function filedown(query,url) {\r\n//   return request({\r\n//     url: url,\r\n//     method: 'get',\r\n//     params: query,\r\n//     responseType: 'blob'\r\n//   })\r\n// }\r\n// export function getPAreaCode(areaCode) {\r\n//   return request({\r\n//     url: '/portal/system/getPAreaCode',\r\n//     method: 'get',\r\n//     params:{areaCode:areaCode}\r\n//   })\r\n// }\r\n//\r\n// export function fileUpImg(url,data) {\r\n//   console.log(url)\r\n//   console.log(data)\r\n//   return request({\r\n//     url: url,\r\n//     method: 'post',\r\n//     data: data,\r\n//     transformRequest: [function (data) {\r\n//       let ret = ''\r\n//       for (let it in data) {\r\n//         ret += encodeURIComponent(it) + '=' + encodeURIComponent(data[it]) + '&'\r\n//       }\r\n//       return ret\r\n//     }],\r\n//     headers: {\r\n//       'Content-Type': 'application/x-www-form-urlencoded'\r\n//     }\r\n//   })\r\n// }\r\nexport function getAreaTree(query) {\r\n  return request({\r\n    url: '/zcpa-portal/system/getAreaTree',\r\n    method: 'get',\r\n    params: query\r\n  })\r\n}\r\nexport function initProvinceCity(query) {\r\n  return request({\r\n    url: '/zcpa-portal/system/getAreaTree?pid=00&type=4',\r\n    method: 'get',\r\n    params: query\r\n  })\r\n}\r\nexport function getDict(ids) {\r\n  return request({\r\n    url: '/zcpa-portal/dict/getByCategoryIds',\r\n    method: 'get',\r\n    params: {categoryIds:ids}\r\n  })\r\n}\r\nexport function fileUpload(fileobj,url) {\r\n  let param = new FormData()\r\n  param.append('file',fileobj.file)\r\n  return request({\r\n    method: 'post',\r\n    url: url,\r\n    headers: {'Content-Type':'multipart/form-data'},\r\n    data: param\r\n  })\r\n}\r\n\r\nexport function filedown(query,url) {\r\n  return request({\r\n    url: url,\r\n    method: 'get',\r\n    params: query,\r\n    responseType: 'blob'\r\n  })\r\n}\r\nexport function getPAreaCode(areaCode) {\r\n  return request({\r\n    url: '/zcpa-portal/system/getPAreaCode',\r\n    method: 'get',\r\n    params:{areaCode:areaCode}\r\n  })\r\n}\r\n\r\nexport function fileUpImg(url,data) {\r\n  return request({\r\n    url: url,\r\n    method: 'post',\r\n    data: data,\r\n    transformRequest: [function (data) {\r\n      let ret = ''\r\n      for (let it in data) {\r\n        ret += encodeURIComponent(it) + '=' + encodeURIComponent(data[it]) + '&'\r\n      }\r\n      return ret\r\n    }],\r\n    headers: {\r\n      'Content-Type': 'application/x-www-form-urlencoded'\r\n    }\r\n  })\r\n}\r\n","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./photo.vue?vue&type=style&index=0&id=223a6de2&lang=less&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./photo.vue?vue&type=style&index=0&id=223a6de2&lang=less&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"uploadImgs\"},[_c('el-form-item',{staticClass:\"same-picture\",class:{picture:_vm.hides},attrs:{\"label\":\"请上传项目封面\",\"prop\":\"imgArr\"}},[_c('el-upload',{class:{hide:_vm.hideUpload},attrs:{\"action\":\"fakeaction\",\"list-type\":\"picture-card\",\"limit\":_vm.limitImgCount,\"file-list\":_vm.imgObj.imgArr,\"http-request\":_vm.uploadServerEdit,\"on-success\":_vm.unitPictrueUploadSuccess,\"on-preview\":_vm.unitPictureCardPreview,\"before-upload\":_vm.beforeAvatarUpload,\"on-remove\":_vm.unitPictrueRemove}},[_c('i',{staticClass:\"el-icon-plus\"})]),_c('div',{staticClass:\"tips\",staticStyle:{\"font-size\":\"12px\"}},[_vm._v(\"仅支持JPG、PNG格式，不超过5M\")]),_c('el-dialog',{staticClass:\"imgShowDemo\",attrs:{\"visible\":_vm.dialogUnitVisible,\"append-to-body\":\"\"},on:{\"update:visible\":function($event){_vm.dialogUnitVisible=$event}}},[_c('img',{attrs:{\"width\":\"100%\",\"src\":_vm.unitImageUrl}})])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"uploadImgs\">\r\n    <el-form-item class=\"same-picture\" :class=\"{picture:hides}\" label=\"请上传项目封面\" prop=\"imgArr\">\r\n      <el-upload\r\n        :class=\"{hide:hideUpload}\"\r\n        action=\"fakeaction\"\r\n        list-type=\"picture-card\"\r\n        :limit=\"limitImgCount\"\r\n        :file-list=\"imgObj.imgArr\"\r\n        :http-request=\"uploadServerEdit\"\r\n        :on-success=\"unitPictrueUploadSuccess\"\r\n        :on-preview=\"unitPictureCardPreview\"\r\n        :before-upload=\"beforeAvatarUpload\"\r\n        :on-remove=\"unitPictrueRemove\"\r\n      >\r\n        <i class=\"el-icon-plus\"></i>\r\n      </el-upload>\r\n      <div class=\"tips\" style=\"font-size:12px;\">仅支持JPG、PNG格式，不超过5M</div>\r\n      <el-dialog class=\"imgShowDemo\" :visible.sync=\"dialogUnitVisible\" append-to-body>\r\n        <img width=\"100%\" :src=\"unitImageUrl\" />\r\n      </el-dialog>\r\n    </el-form-item>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { fileUpImg } from \"@/api/sys\";\r\nexport default {\r\n  name: \"photo\",\r\n  props: {\r\n    submitType: {\r\n      type: String\r\n    },\r\n    form: {\r\n      type: Object\r\n    }\r\n  },\r\n  watch: {\r\n    submitType: {\r\n      handler(newName, oldName) {\r\n        if (newName) {\r\n          this.submitType = newName;\r\n        }\r\n      },\r\n      immediate: true, //立刻\r\n      deep: true\r\n    },\r\n    //form数据\r\n    \"form.fmUrl\": {\r\n      handler(newName, oldName) {\r\n        console.log(newName);\r\n        if (newName) {\r\n          console.log(newName);\r\n          this.initEditForm({ fmUrl: newName });\r\n        }\r\n      },\r\n      immediate: false, //立刻\r\n      deep: true\r\n    },\r\n    \"imgObj.imgArr\": {\r\n      handler(newName, oldName) {\r\n        var img = newName[0];\r\n        if (img && img.url) {\r\n          this.form.fmUrl = img.url;\r\n        } else {\r\n          this.form.fmUrl = \"\";\r\n        }\r\n      },\r\n      immediate: false, //立刻\r\n      deep: true\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      limitImgCount: 1, //限制文件上传数量\r\n      hideUpload: false, //隐藏上传图片按钮\r\n      dialogUnitVisible: false, //dialog预览图片属性\r\n      unitImageUrl: \"\", //显示预览的图片\r\n      hides: false, //隐藏报错信息\r\n      imgObj: {\r\n        imgArr: [], //前端显示参数\r\n        fmUrl: \"\" //后台参数\r\n      }\r\n    };\r\n  },\r\n  created() {\r\n    this.initEditForm(this.form.fmUrl);\r\n  },\r\n  methods: {\r\n    //初始化编辑表单数据\r\n    initEditForm(data) {\r\n      var fmUrl = data.fmUrl;\r\n      //图片格式化\r\n      if (fmUrl != null && fmUrl != \"\") {\r\n        var tempImgArr = fmUrl.split(\",\"); //以逗号打撒\r\n        var imgArr = [];\r\n        if (tempImgArr.length > 0) {\r\n          tempImgArr.forEach((item, i) => {\r\n            imgArr.push({ url: item });\r\n          });\r\n        }\r\n        this.imgObj.imgArr = imgArr; //前端展示用array\r\n        this.imgObj.fmUrl = fmUrl; //赋值后端字段string\r\n        var limitImgCount = this.limitImgCount;\r\n        if (imgArr.length > limitImgCount || imgArr.length == limitImgCount) {\r\n          this.hideUpload = true; // 隐藏上传按钮\r\n        }\r\n      }\r\n    },\r\n    //相册上传\r\n    unitPictrueUploadSuccess(response, file, fileList) {\r\n      if (response.status == 1) {\r\n        var imgArr = this.imgObj.imgArr;\r\n        var tempArr = [];\r\n        imgArr.push({\r\n          url: response.data\r\n        }); // push response.data进去 里面含3个字段\r\n        if (imgArr.length > 0) {\r\n          imgArr.forEach(item => {\r\n            tempArr.push(item.url);\r\n          });\r\n        }\r\n        this.imgObj.imgArr = imgArr; //更新data数据\r\n        this.imgObj.pictureStr = tempArr.join(\",\");\r\n        if (imgArr.length >= this.limitImgCount) {\r\n          this.hideUpload = true; //隐藏上传按钮\r\n        }\r\n      }\r\n    },\r\n    //编辑图片上传服务器\r\n    uploadServerEdit(param) {\r\n      var that = this;\r\n      // 获取文件对象\r\n      let file = param.file;\r\n      // 创建一个HTML5的FileReader对象\r\n      var reader = new FileReader();\r\n      //创建一个img对象\r\n      var img = new Image();\r\n      let filename = param.filename;\r\n      if (file) {\r\n        reader.readAsDataURL(file);\r\n      }\r\n      var newUrl = null;\r\n      reader.onload = e => {\r\n        let base64Str = reader.result.split(\",\")[1];\r\n        img.src = e.target.result;\r\n        // base64地址图片加载完毕后执行\r\n        img.onload = function() {\r\n          // 缩放图片需要的canvas（也可以在DOM中直接定义canvas标签，这样就能把压缩完的图片不转base64也能直接显示出来）\r\n          var canvas = document.createElement(\"canvas\");\r\n          var context = canvas.getContext(\"2d\");\r\n          // 图片原始尺寸\r\n          var originWidth = this.width;\r\n          var originHeight = this.height;\r\n          // 最大尺寸限制，可通过设置宽高来实现图片压缩程度\r\n          var maxWidth = that.globalData.albumWidth * 2,\r\n            maxHeight = that.globalData.albumHeight * 2;\r\n          // 目标尺寸\r\n          var targetWidth = originWidth,\r\n            targetHeight = originHeight;\r\n          // 图片尺寸超过最大尺寸的限制\r\n          if (originWidth > maxWidth || originHeight > maxHeight) {\r\n            if (originWidth / originHeight > maxWidth / maxHeight) {\r\n              // 更改宽度，按照宽度限定尺寸\r\n              targetWidth = maxWidth;\r\n              targetHeight = Math.round(\r\n                maxWidth * (originHeight / originWidth)\r\n              );\r\n            } else {\r\n              targetHeight = maxHeight;\r\n              targetWidth = Math.round(\r\n                maxHeight * (originWidth / originHeight)\r\n              );\r\n            }\r\n          }\r\n          //对图片进行缩放\r\n          canvas.width = targetWidth;\r\n          canvas.height = targetHeight;\r\n          // 清除画布\r\n          context.clearRect(0, 0, targetWidth, targetHeight);\r\n          // 图片压缩\r\n          context.drawImage(img, 0, 0, targetWidth, targetHeight);\r\n          /*第一个参数是创建的img对象；第二三个参数是左上角坐标，后面两个是画布区域宽高*/\r\n          //压缩后的base64文件\r\n          newUrl = canvas.toDataURL(\"image/jpeg\", 0.7);\r\n          // 根据后台需求数据格式\r\n          const formData = new FormData();\r\n          // 文件对象\r\n          let obj = {};\r\n          if (that.submitType == \"edit\") {\r\n            that.actionUrls = \"/zcpa/actProject/updateCoverUrl\";\r\n            obj.projectId = that.form.id;\r\n            obj.coverUrl = newUrl;\r\n          } else {\r\n            that.actionUrls = \"/portal/www/uploadFileBase\";\r\n            obj.file = newUrl;\r\n          }\r\n          that.imageUpload(obj);\r\n        };\r\n      };\r\n    },\r\n    //图片上传\r\n    imageUpload(obj) {\r\n      fileUpImg(this.actionUrls, obj).then(response => {\r\n        if (response.status == 1) {\r\n          var imgArr = this.imgObj.imgArr;\r\n          var tempArr = [];\r\n          imgArr.push({ url: response.data }); // push response.data进去 里面含3个字段\r\n          if (imgArr.length > 0) {\r\n            imgArr.forEach(item => {\r\n              tempArr.push(item.url);\r\n            });\r\n          }\r\n          this.imgObj.imgArr = imgArr; //更新data数据\r\n          this.imgObj.fmUrl = tempArr.join(\",\");\r\n          if (imgArr.length >= this.limitImgCount) {\r\n            this.hideUpload = true; //隐藏上传按钮\r\n            this.hides = true;\r\n          }\r\n        } else {\r\n          this.$message({\r\n            message: response.message,\r\n            type: \"warning\"\r\n          });\r\n        }\r\n      });\r\n    },\r\n    //限制用户上传的图片格式和大小\r\n    beforeAvatarUpload(file) {\r\n      var isRightType = /^image\\/(jpeg|png|jpg)$/.test(file.type);\r\n      var imgSize = file.size / 1024 / 1024 < 5;\r\n      if (!isRightType) {\r\n        this.$message.warning(\"上传头像图片只能是 jpg、jpeg、png 格式!\");\r\n      }\r\n      if (!imgSize) {\r\n        this.$message.warning(\"上传头像图片大小不能超过 5MB!\");\r\n      }\r\n      return isRightType && imgSize;\r\n    },\r\n    // 移除图片之前\r\n    unitPictrueBeforeRemove(file, fileList) {\r\n      console.log(file);\r\n      console.log(fileList);\r\n    },\r\n    // 移除图片\r\n    unitPictrueRemove(file, fileList) {\r\n      console.log(file);\r\n      console.log(fileList);\r\n      var imgArrTemp = this.imgObj.imgArr;\r\n      if (file.status == \"success\") {\r\n        imgArrTemp.forEach((item, i) => {\r\n          var url = file.url; // 接口返回值没有逗号，加一个逗号\r\n          if (item.url == url) {\r\n            imgArrTemp.splice(i, 1);\r\n          }\r\n        });\r\n        this.imgObj.imgArr = imgArrTemp; //更新data imgArr 数据\r\n        var tempArr = [];\r\n        if (imgArrTemp.length > 0) {\r\n          imgArrTemp.forEach((item, i) => {\r\n            tempArr.push(item.url);\r\n          });\r\n        }\r\n        this.imgObj.fmUrl = tempArr.join(\",\"); //更新data pictureStr 数据\r\n        if (imgArrTemp.length < this.limitImgCount) {\r\n          this.hideUpload = false; //显示上传按钮\r\n        }\r\n      }\r\n    },\r\n    // 图片预览\r\n    unitPictureCardPreview(file) {\r\n      this.unitImageUrl = file.url;\r\n      this.dialogUnitVisible = true;\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.uploadImgs {\r\n  .hide {\r\n    height: 220px;\r\n    overflow: hidden;\r\n    /deep/ .el-upload--picture-card {\r\n      display: none;\r\n    }\r\n    /deep/ .el-upload-list--picture-card {\r\n      height: 220px;\r\n      overflow: hidden;\r\n    }\r\n  }\r\n}\r\n.uploadImgs /deep/ .el-upload--picture-card {\r\n  width: 200px;\r\n  height: 200px;\r\n}\r\n.uploadImgs /deep/ .el-upload-list--picture-card .el-upload-list__item {\r\n  width: 200px;\r\n  height: 200px;\r\n}\r\n\r\n.uploadImgs\r\n  /deep/\r\n  .el-upload-list--picture-card\r\n  .el-upload-list__item-thumbnail {\r\n  object-fit: cover;\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.uploadImgs /deep/ .el-upload--picture-card i {\r\n  line-height: 200px;\r\n}\r\n\r\n.imgShowDemo /deep/ .el-dialog {\r\n  width: 520px;\r\n  height: 520px !important;\r\n  overflow: hidden;\r\n  margin-top: 5% !important;\r\n}\r\n.imgShowDemo /deep/ .el-dialog__header {\r\n  height: 50px;\r\n}\r\n.imgShowDemo /deep/ .el-dialog__body {\r\n  width: 520px;\r\n  height: 480px;\r\n  margin: 0 auto;\r\n}\r\n.imgShowDemo /deep/ .el-dialog .el-dialog__body img {\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: cover;\r\n}\r\n</style>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./photo.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./photo.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./photo.vue?vue&type=template&id=223a6de2&scoped=true&\"\nimport script from \"./photo.vue?vue&type=script&lang=js&\"\nexport * from \"./photo.vue?vue&type=script&lang=js&\"\nimport style0 from \"./photo.vue?vue&type=style&index=0&id=223a6de2&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"223a6de2\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}