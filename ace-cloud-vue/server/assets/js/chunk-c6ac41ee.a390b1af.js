(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c6ac41ee"],{6797:function(t,e,i){"use strict";i.d(e,"d",function(){return a}),i.d(e,"e",function(){return n}),i.d(e,"b",function(){return o}),i.d(e,"c",function(){return s}),i.d(e,"a",function(){return l});var r=i("b775");function a(t){return Object(r["a"])({url:"/zcpa-portal/system/getAreaTree",method:"get",params:t})}function n(t){return Object(r["a"])({url:"/zcpa-portal/dict/getByCategoryIds",method:"get",params:{categoryIds:t}})}function o(t,e){var i=new FormData;return i.append("file",t.file),Object(r["a"])({method:"post",url:e,headers:{"Content-Type":"multipart/form-data"},data:i})}function s(t,e){return Object(r["a"])({url:e,method:"get",params:t,responseType:"blob"})}function l(t,e){return Object(r["a"])({url:t,method:"post",data:e,transformRequest:[function(t){var e="";for(var i in t)e+=encodeURIComponent(i)+"="+encodeURIComponent(t[i])+"&";return e}],headers:{"Content-Type":"application/x-www-form-urlencoded"}})}},"886e":function(t,e,i){"use strict";var r=i("f849"),a=i.n(r);a.a},b70e:function(t,e,i){"use strict";i.r(e);var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"uploadImgs"},[i("el-form-item",{staticClass:"same-picture",class:{picture:t.hides},attrs:{label:"请上传项目封面",prop:"imgArr"}},[i("el-upload",{class:{hide:t.hideUpload},attrs:{action:"fakeaction","list-type":"picture-card",limit:t.limitImgCount,"file-list":t.imgObj.imgArr,"http-request":t.uploadServerEdit,"on-success":t.unitPictrueUploadSuccess,"on-preview":t.unitPictureCardPreview,"before-upload":t.beforeAvatarUpload,"on-remove":t.unitPictrueRemove}},[i("i",{staticClass:"el-icon-plus"})]),i("div",{staticClass:"tips",staticStyle:{"font-size":"12px"}},[t._v("仅支持JPG、PNG格式，不超过5M")]),i("el-dialog",{staticClass:"imgShowDemo",attrs:{visible:t.dialogUnitVisible,"append-to-body":""},on:{"update:visible":function(e){t.dialogUnitVisible=e}}},[i("img",{attrs:{width:"100%",src:t.unitImageUrl}})])],1)],1)},a=[],n=(i("ac6a"),i("28a5"),i("6797")),o={name:"photo",props:{submitType:{type:String},form:{type:Object}},watch:{submitType:{handler:function(t,e){t&&(this.submitType=t)},immediate:!0,deep:!0},"form.fmUrl":{handler:function(t,e){console.log(t),t&&(console.log(t),this.initEditForm({fmUrl:t}))},immediate:!1,deep:!0},"imgObj.imgArr":{handler:function(t,e){var i=t[0];i&&i.url?this.form.fmUrl=i.url:this.form.fmUrl=""},immediate:!1,deep:!0}},data:function(){return{limitImgCount:1,hideUpload:!1,dialogUnitVisible:!1,unitImageUrl:"",hides:!1,imgObj:{imgArr:[],fmUrl:""}}},created:function(){this.initEditForm(this.form.fmUrl)},methods:{initEditForm:function(t){var e=t.fmUrl;if(null!=e&&""!=e){var i=e.split(","),r=[];i.length>0&&i.forEach(function(t,e){r.push({url:t})}),this.imgObj.imgArr=r,this.imgObj.fmUrl=e;var a=this.limitImgCount;(r.length>a||r.length==a)&&(this.hideUpload=!0)}},unitPictrueUploadSuccess:function(t,e,i){if(1==t.status){var r=this.imgObj.imgArr,a=[];r.push({url:t.data}),r.length>0&&r.forEach(function(t){a.push(t.url)}),this.imgObj.imgArr=r,this.imgObj.pictureStr=a.join(","),r.length>=this.limitImgCount&&(this.hideUpload=!0)}},uploadServerEdit:function(t){var e=this,i=t.file,r=new FileReader,a=new Image;t.filename;i&&r.readAsDataURL(i);var n=null;r.onload=function(t){r.result.split(",")[1];a.src=t.target.result,a.onload=function(){var t=document.createElement("canvas"),i=t.getContext("2d"),r=this.width,o=this.height,s=2*e.globalData.albumWidth,l=2*e.globalData.albumHeight,u=r,c=o;(r>s||o>l)&&(r/o>s/l?(u=s,c=Math.round(s*(o/r))):(c=l,u=Math.round(l*(r/o)))),t.width=u,t.height=c,i.clearRect(0,0,u,c),i.drawImage(a,0,0,u,c),n=t.toDataURL("image/jpeg",.7);new FormData;var m={};"edit"==e.submitType?(e.actionUrls="/zcpa/actProject/updateCoverUrl",m.projectId=e.form.id,m.coverUrl=n):(e.actionUrls="/portal/www/uploadFileBase",m.file=n),e.imageUpload(m)}}},imageUpload:function(t){var e=this;Object(n["a"])(this.actionUrls,t).then(function(t){if(1==t.status){var i=e.imgObj.imgArr,r=[];i.push({url:t.data}),i.length>0&&i.forEach(function(t){r.push(t.url)}),e.imgObj.imgArr=i,e.imgObj.fmUrl=r.join(","),i.length>=e.limitImgCount&&(e.hideUpload=!0,e.hides=!0)}else e.$message({message:t.message,type:"warning"})})},beforeAvatarUpload:function(t){var e=/^image\/(jpeg|png|jpg)$/.test(t.type),i=t.size/1024/1024<5;return e||this.$message.warning("上传头像图片只能是 jpg、jpeg、png 格式!"),i||this.$message.warning("上传头像图片大小不能超过 5MB!"),e&&i},unitPictrueBeforeRemove:function(t,e){console.log(t),console.log(e)},unitPictrueRemove:function(t,e){console.log(t),console.log(e);var i=this.imgObj.imgArr;if("success"==t.status){i.forEach(function(e,r){var a=t.url;e.url==a&&i.splice(r,1)}),this.imgObj.imgArr=i;var r=[];i.length>0&&i.forEach(function(t,e){r.push(t.url)}),this.imgObj.fmUrl=r.join(","),i.length<this.limitImgCount&&(this.hideUpload=!1)}},unitPictureCardPreview:function(t){this.unitImageUrl=t.url,this.dialogUnitVisible=!0}}},s=o,l=(i("886e"),i("2877")),u=Object(l["a"])(s,r,a,!1,null,"223a6de2",null);e["default"]=u.exports},f849:function(t,e,i){}}]);
//# sourceMappingURL=chunk-c6ac41ee.a390b1af.js.map