(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bf2dded2"],{"5be1":function(e,t,r){"use strict";var a=r("f6c0"),i=r.n(a);i.a},6797:function(e,t,r){"use strict";r.d(t,"d",function(){return i}),r.d(t,"e",function(){return o}),r.d(t,"b",function(){return s}),r.d(t,"c",function(){return l}),r.d(t,"a",function(){return n});var a=r("b775");function i(e){return Object(a["a"])({url:"/zcpa-portal/system/getAreaTree",method:"get",params:e})}function o(e){return Object(a["a"])({url:"/zcpa-portal/dict/getByCategoryIds",method:"get",params:{categoryIds:e}})}function s(e,t){var r=new FormData;return r.append("file",e.file),Object(a["a"])({method:"post",url:t,headers:{"Content-Type":"multipart/form-data"},data:r})}function l(e,t){return Object(a["a"])({url:t,method:"get",params:e,responseType:"blob"})}function n(e,t){return Object(a["a"])({url:e,method:"post",data:t,transformRequest:[function(e){var t="";for(var r in e)t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r])+"&";return t}],headers:{"Content-Type":"application/x-www-form-urlencoded"}})}},7514:function(e,t,r){"use strict";var a=r("5ca1"),i=r("0a49")(5),o="find",s=!0;o in[]&&Array(1)[o](function(){s=!1}),a(a.P+a.F*s,"Array",{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),r("9c6c")(o)},acd6:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"declare"},[r("el-dialog",{attrs:{title:e.titles,visible:e.addVisible},on:{"update:visible":function(t){e.addVisible=t},close:function(t){return e.eliminateDialog("addsForm")}}},[r("el-form",{ref:"addsForm",staticClass:"addForm",attrs:{model:e.addsForm,rules:e.addsRules,"label-width":"140px"}},[r("div",{staticClass:"form-item-box"},[r("div",{staticClass:"left"},[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"项目名称",prop:"projectName"}},[r("el-input",{staticClass:"input-right",attrs:{type:"text",placeholder:"请输入项目名称, 限制50个字以内",maxlength:"50",clearable:"","show-word-limit":""},model:{value:e.addsForm.projectName,callback:function(t){e.$set(e.addsForm,"projectName",t)},expression:"addsForm.projectName"}})],1)],1),e.isLevel?r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"项目级别",prop:"projectLevel"}},[r("el-select",{attrs:{disabled:e.disableds,clearable:"",placeholder:"请选择项目级别"},model:{value:e.addsForm.projectLevel,callback:function(t){e.$set(e.addsForm,"projectLevel",t)},expression:"addsForm.projectLevel"}},e._l(e.projectLevelArr,function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})}),1)],1)],1):e._e(),r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"项目类型",prop:"category"}},[r("el-select",{attrs:{clearable:"",disabled:e.disableds,placeholder:"请选择项目类型"},on:{change:e.changeProjectType},model:{value:e.addsForm.category,callback:function(t){e.$set(e.addsForm,"category",t)},expression:"addsForm.category"}},e._l(e.projectTypeArr,function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})}),1)],1)],1),e.isShow?r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"需对接志愿者数",prop:"peopleNumber"}},[r("el-input",{attrs:{placeholder:"请输入需对接志愿者数",clearable:""},model:{value:e.addsForm.peopleNumber,callback:function(t){e.$set(e.addsForm,"peopleNumber",t)},expression:"addsForm.peopleNumber"}},[r("template",{slot:"append"},[e._v("人")])],2)],1)],1):e._e(),r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"项目积分",prop:"jiFen"}},[r("el-input",{attrs:{disabled:e.disableds,placeholder:"请输入积分，只能是正整数",clearable:""},model:{value:e.addsForm.jiFen,callback:function(t){e.$set(e.addsForm,"jiFen",t)},expression:"addsForm.jiFen"}},[r("template",{staticStyle:{"background-color":"rgb(255,255,255)",width:"120px"},slot:"prepend"},[e._v("活动积分")]),r("template",{slot:"append"},[e._v("积分/次")])],2)],1),r("el-tooltip",{attrs:{placement:"top"}},[r("div",{attrs:{slot:"content"},slot:"content"},[e._v("19活动为每月17号至21号")]),r("el-form-item",{attrs:{content:"19活动为每月17号至21号",placement:"top-start",prop:"nineteenJiFen"}},[r("el-input",{attrs:{placeholder:"请输入积分，只能是正整数",disabled:e.disableds,clearable:""},model:{value:e.addsForm.nineteenJiFen,callback:function(t){e.$set(e.addsForm,"nineteenJiFen",t)},expression:"addsForm.nineteenJiFen"}},[r("template",{staticStyle:{"background-color":"#ffffff!important",width:"120px"},slot:"prepend"},[e._v("19活动积分")]),r("template",{slot:"append"},[e._v("积分/月")])],2)],1)],1)],1),e.isAreaCode?r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"行政区划",prop:"areaCodeArr"}},[r("el-cascader",{attrs:{placeholder:"请选择行政区划",options:e.cityCountyOptions,props:e.zxProps,disabled:e.disabledAreaCode,"change-on-select":!0,clearable:"",filterable:""},on:{change:e.cascaderExecutiveLevel},model:{value:e.addsForm.areaCodeArr,callback:function(t){e.$set(e.addsForm,"areaCodeArr",t)},expression:"addsForm.areaCodeArr"}})],1)],1):e._e(),r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"开始时间",prop:"startTime"}},[r("el-date-picker",{attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":e.addstartPicker,clearable:"",placeholder:"请选择开始日期"},model:{value:e.addsForm.startTime,callback:function(t){e.$set(e.addsForm,"startTime",t)},expression:"addsForm.startTime"}})],1)],1),r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"结束时间",prop:"endTime"}},[r("el-date-picker",{attrs:{clearable:"",format:"yyyy-MM-dd","picker-options":e.addendPicker,"value-format":"yyyy-MM-dd",placeholder:"请选择结束日期"},model:{value:e.addsForm.endTime,callback:function(t){e.$set(e.addsForm,"endTime",t)},expression:"addsForm.endTime"}})],1)],1),e.isEdit?r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"项目状态",prop:"projectState"}},[r("el-select",{attrs:{disabled:e.disableds,clearable:"",placeholder:"请选择项目状态"},model:{value:e.addsForm.projectState,callback:function(t){e.$set(e.addsForm,"projectState",t)},expression:"addsForm.projectState"}},e._l(e.statusValueArr,function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})}),1)],1)],1):e._e(),r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"项目介绍",prop:"summary"}},[r("el-input",{staticClass:"textarea-bottom",attrs:{type:"textarea",placeholder:"请输入项目介绍内容，字数不可超过1000字",maxlength:"1000","show-word-limit":"",rows:"5",clearable:""},model:{value:e.addsForm.summary,callback:function(t){e.$set(e.addsForm,"summary",t)},expression:"addsForm.summary"}})],1)],1)],1),r("div",{staticClass:"right"},[r("div",{staticClass:"uploadImgs"},[r("el-form-item",{staticClass:"same-picture",class:{isError:e.hideError},attrs:{label:"请上传项目封面",prop:"imgArr"}},[r("el-upload",{class:{hide:e.hideUpload},attrs:{action:"fakeaction","list-type":"picture-card",limit:e.limitImgCount,"file-list":e.addsForm.imgArr,"http-request":e.uploadServerEdit,"on-success":e.unitPictrueUploadSuccess,"on-preview":e.unitPictureCardPreview,"before-upload":e.beforeAvatarUpload,"on-remove":e.unitPictrueRemove}},[r("i",{staticClass:"el-icon-plus"})]),r("div",{staticClass:"tips",staticStyle:{"font-size":"12px"}},[e._v("仅支持JPG、PNG格式，不超过5M")]),r("el-dialog",{staticClass:"imgShowDemo",attrs:{visible:e.dialogUnitVisible,"append-to-body":""},on:{"update:visible":function(t){e.dialogUnitVisible=t}}},[r("img",{attrs:{width:"100%",src:e.unitImageUrl}})])],1)],1)])])]),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){return e.canle("addsForm")}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.totalSubmit("addsForm")}}},[e._v("确 定")])],1)],1)],1)},i=[],o=(r("7f7f"),r("7514"),r("ac6a"),r("28a5"),r("6797")),s={props:{submitType:{type:String},title:{type:String},dictArrayObj:{type:Object},byIdData:{type:Object},areaCodeOptions:{type:Array},cityCountyOptions:{type:Array}},watch:{submitType:{handler:function(e,t){e&&(this.submitType=e)},immediate:!0,deep:!0},cityCountyOptions:{handler:function(e,t){},immediate:!0,deep:!0},title:{handler:function(e,t){e&&(this.titles=e)},immediate:!0,deep:!0},dictArrayObj:{handler:function(e,t){this.initDictData(e)},immediate:!0,deep:!0},byIdData:{handler:function(e,t){"{}"!=JSON.stringify(e)&&this.initEditForm(e)},immediate:!0,deep:!0}},name:"basic",data:function(){return{showWordLimit:!0,addVisible:!1,titles:"",limitImgCount:1,hideUpload:!1,hideError:!1,dialogUnitVisible:!1,unitImageUrl:"",isShow:!0,disableds:!0,isEdit:!1,isLevel:!1,isAreaCode:!1,disabledAreaCode:!0,addstartPicker:this.addStartPickers(),addendPicker:this.addEndPickers(),projectLevelArr:[],addsForm:{projectName:"",category:"",projectLevel:"",startTime:"",endTime:"",summary:"",jiFen:"",nineteenJiFen:"",peopleNumber:"",areaCode:"",areaCodeArr:[],maxLengthValue:"",projectState:"",imgArr:[],fmUrl:""},addsRules:{projectName:[{required:!0,message:"请输入项目名称",trigger:"blur"}],category:[{required:!0,message:"请选择项目类型",trigger:"change"}],areaCodeArr:[{required:!0,message:"请选择行政区划",trigger:"change"}],projectLevel:[{required:!0,message:"请选择项目等级",trigger:"change"}],jiFen:[{required:!0,message:"请输入活动积分",trigger:"blur"},{validator:this.globalMethods.checkIntegerP,trigger:"blur"}],nineteenJiFen:[{required:!0,message:"请输入19活动积分",trigger:"blur"},{validator:this.globalMethods.checkIntegerP,trigger:"blur"}],startTime:[{required:!0,message:"请选择开始时间",trigger:"change"}],endTime:[{required:!0,message:"请选择结束时间",trigger:"change"}],projectState:[{required:!0,message:"请选择项目状态",trigger:"change"}],summary:[{required:!0,message:"请输入项目介绍内容，字数不可超过1000字",trigger:"blur"},{validator:this.globalMethods.checkTextarea,trigger:"blur"}],peopleNumber:[{required:!0,message:"请输入需对接志愿者数",trigger:"blur"},{validator:this.globalMethods.checkIntegerP,trigger:"blur"}],imgArr:[{required:!0,message:"请上传封面图片"}]},zxProps:{value:"id",label:"text"}}},created:function(){},methods:{initEditForm:function(e){if(e&&(this.addsForm={id:e.id,projectName:e.projectName,category:e.category,projectLevel:e.projectLevel,peopleNumber:e.peopleNumber,jiFen:e.jiFen,nineteenJiFen:e.nineteenJiFen,startTime:e.startTime,endTime:e.endTime,SupstartTime:e.SupstartTime,SupendTime:e.SupendTime,summary:e.summary,areaCode:e.areaCode,areaCodeArr:e.areaCodeArr,projectState:e.projectState,fmUrl:e.fmUrl}),null!=e.fmUrl&&""!=e.fmUrl){var t=e.fmUrl.split(","),r=[];t.length>0&&t.forEach(function(e,t){r.push({url:e})}),this.addsForm.imgArr=r,this.addsForm.fmUrl=e.fmUrl;var a=this.limitImgCount;(r.length>a||r.length==a)&&(this.hideUpload=!0)}},totalSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.$emit("totalSubmit")})},eliminateDialog:function(e){e&&this.$refs[e].resetFields()},canle:function(e){var t=this;this.$nextTick(function(){t.$refs[e].resetFields()}),this.addVisible=!1},addStartPickers:function(){var e=this;return{disabledDate:function(t){return e.addsForm.SupstartTime&&(t.getTime()<new Date(e.addsForm.SupstartTime).getTime()-864e5||t.getTime()>new Date(e.addsForm.SupendTime).getTime())||t.getTime()>new Date(e.addsForm.endTime).getTime()}}},addEndPickers:function(){var e=this;return{disabledDate:function(t){return e.addsForm.SupendTime&&(t.getTime()<new Date(e.addsForm.SupstartTime).getTime()-864e5||t.getTime()>new Date(e.addsForm.SupendTime).getTime())||new Date(e.addsForm.startTime).getTime()-864e5>t.getTime()}}},unitPictrueUploadSuccess:function(e,t,r){if(1==e.status){var a=this.addsForm.imgArr,i=[];a.push({url:e.data}),a.length>0&&a.forEach(function(e){i.push(e.url)}),this.addsForm.imgArr=a,this.addsForm.fmUrl=i.join(","),a.length>=this.limitImgCount&&(this.hideUpload=!0,this.hideError=!0)}},uploadServerEdit:function(e){var t=this,r=e.file,a=new FileReader,i=new Image;e.filename;r&&a.readAsDataURL(r);var o=null;a.onload=function(e){a.result.split(",")[1];i.src=e.target.result,i.onload=function(){var e=document.createElement("canvas"),r=e.getContext("2d"),a=this.width,s=this.height,l=2*t.globalData.albumWidth,n=2*t.globalData.albumHeight,d=a,c=s;(a>l||s>n)&&(a/s>l/n?(d=l,c=Math.round(l*(s/a))):(c=n,d=Math.round(n*(a/s)))),e.width=d,e.height=c,r.clearRect(0,0,d,c),r.drawImage(i,0,0,d,c),o=e.toDataURL("image/jpeg",.7);new FormData;var m={};"edit"==t.submitType?(t.actionUrls="/zcpa/actProject/updateCoverUrl",m.projectId=t.byIdData.id,m.coverUrl=o):(t.actionUrls="/zcpa-portal/www/uploadFileBase",m.file=o),t.imageUpload(m)}}},imageUpload:function(e){var t=this;Object(o["a"])(this.actionUrls,e).then(function(e){if(1==e.status){var r=t.addsForm.imgArr,a=[];r.push({url:e.data}),r.length>0&&r.forEach(function(e){a.push(e.url)}),t.addsForm.imgArr=r,t.addsForm.fmUrl=a.join(","),r.length>=t.limitImgCount&&(t.hideUpload=!0,t.hideError=!0)}else t.$message({message:e.message,type:"warning"})})},beforeAvatarUpload:function(e){var t=/^image\/(jpeg|png|jpg)$/.test(e.type),r=e.size/1024/1024<5;return t||this.$message.warning("上传头像图片只能是 jpg、jpeg、png 格式!"),r||this.$message.warning("上传头像图片大小不能超过 5MB!"),t&&r},unitPictrueBeforeRemove:function(e,t){console.log(e),console.log(t)},unitPictrueRemove:function(e,t){console.log(e),console.log(t);var r=this.addsForm.imgArr;if("success"==e.status){r.forEach(function(t,a){var i=e.url;t.url==i&&r.splice(a,1)}),this.addsForm.imgArr=r;var a=[];r.length>0&&r.forEach(function(e,t){a.push(e.url)}),this.addsForm.fmUrl=a.join(","),r.length<this.limitImgCount&&(this.hideUpload=!1,this.hideError=!1)}},unitPictureCardPreview:function(e){this.unitImageUrl=e.url,this.dialogUnitVisible=!0},changeProjectType:function(e){var t={};t=this.projectTypeArr.find(function(t){return t.code==e}),e&&(this.addsForm.category=e,this.addsForm.categoryType=t.name,this.isShow=1!=e)},cascaderExecutiveLevel:function(e){var t=[],r=this.globalMethods.getCascaderObj(e,this.cityCountyOptions);r.length>0&&r.forEach(function(e,r){t.push(e.text)});var a=this.globalMethods.findLongestWord([].concat(e));this.addsForm.areaCode=a,console.log(this.addsForm.areaCode)},initDictData:function(){this.projectTypeArr=this.dictArrayObj.projectValue,this.projectLevelArr=this.dictArrayObj.ProjectLevelValue,this.statusValueArr=this.dictArrayObj.statusValue}}},l=s,n=(r("5be1"),r("2877")),d=Object(n["a"])(l,a,i,!1,null,"8b387836",null);t["default"]=d.exports},f6c0:function(e,t,r){}}]);
//# sourceMappingURL=chunk-bf2dded2.fa8207ed.js.map